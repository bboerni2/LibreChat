# Please consult our docs for more info: https://www.librechat.ai/docs/configuration/docker_override
#
# Dieses Override wird zusammen mit Portainer-Variablen verwendet:
# - .env (im Repo) enth√§lt die public Defaults
# - Portainer h√§lt die echten Werte (v.a. Secrets)
# - Dieses File mapped nur die Variablen, die aus Portainer ins Deployment sollen.

services:
  api:
    environment:
      ###########################################################################
      # üîµ Basis / Debug
      ###########################################################################
      DEBUG_CONSOLE: ${DEBUG_CONSOLE}
      DEBUG_LOGGING: ${DEBUG_LOGGING}
      DEBUG_OPENAI: ${DEBUG_OPENAI}
      DEBUG_PLUGINS: ${DEBUG_PLUGINS}
      CONSOLE_JSON: ${CONSOLE_JSON}
      NO_INDEX: ${NO_INDEX}
      TRUST_PROXY: ${TRUST_PROXY}

      ###########################################################################
      # üåê Domains
      ###########################################################################
      DOMAIN_CLIENT: ${DOMAIN_CLIENT}
      DOMAIN_SERVER: ${DOMAIN_SERVER}

      ###########################################################################
      # üßë‚Äçüíª Auth-Optionen 
      ###########################################################################
      ALLOW_SOCIAL_LOGIN: ${ALLOW_SOCIAL_LOGIN}
      ALLOW_EMAIL_LOGIN: ${ALLOW_EMAIL_LOGIN}
      ALLOW_REGISTRATION: ${ALLOW_REGISTRATION}
      ALLOW_PASSWORD_RESET: ${ALLOW_PASSWORD_RESET}
      ALLOW_UNVERIFIED_EMAIL_LOGIN: ${ALLOW_UNVERIFIED_EMAIL_LOGIN}

      ###########################################################################
      # üîê Krypto / Tokens 
      ###########################################################################
      CREDS_KEY: ${CREDS_KEY}
      CREDS_IV: ${CREDS_IV}
      JWT_SECRET: ${JWT_SECRET}
      JWT_REFRESH_SECRET: ${JWT_REFRESH_SECRET}
      SESSION_EXPIRY: ${SESSION_EXPIRY}
      REFRESH_TOKEN_EXPIRY: ${REFRESH_TOKEN_EXPIRY}
      MEILI_MASTER_KEY: ${MEILI_MASTER_KEY}

      ###########################################################################
      # ü™™ OpenID-Login
      ###########################################################################
      OPENID_CLIENT_ID: ${OPENID_CLIENT_ID}
      OPENID_CLIENT_SECRET: ${OPENID_CLIENT_SECRET}
      OPENID_ISSUER: ${OPENID_ISSUER}
      OPENID_SESSION_SECRET: ${OPENID_SESSION_SECRET}
      OPENID_SCOPE: ${OPENID_SCOPE}
      OPENID_CALLBACK_URL: ${OPENID_CALLBACK_URL}

      # Rollen / Claims
      OPENID_REQUIRED_ROLE: ${OPENID_REQUIRED_ROLE}
      OPENID_REQUIRED_ROLE_TOKEN_KIND: ${OPENID_REQUIRED_ROLE_TOKEN_KIND}
      OPENID_REQUIRED_ROLE_PARAMETER_PATH: ${OPENID_REQUIRED_ROLE_PARAMETER_PATH}

      OPENID_ADMIN_ROLE: ${OPENID_ADMIN_ROLE}
      OPENID_ADMIN_ROLE_TOKEN_KIND: ${OPENID_ADMIN_ROLE_TOKEN_KIND}
      OPENID_ADMIN_ROLE_PARAMETER_PATH: ${OPENID_ADMIN_ROLE_PARAMETER_PATH}

      # UI / Verhalten
      OPENID_BUTTON_LABEL: ${OPENID_BUTTON_LABEL}
      OPENID_IMAGE_URL: ${OPENID_IMAGE_URL}
      OPENID_AUTO_REDIRECT: ${OPENID_AUTO_REDIRECT}
      OPENID_USE_PKCE: ${OPENID_USE_PKCE}
      OPENID_REUSE_TOKENS: ${OPENID_REUSE_TOKENS}

      # People Search / Graph
      USE_ENTRA_ID_FOR_PEOPLE_SEARCH: ${USE_ENTRA_ID_FOR_PEOPLE_SEARCH}
      ENTRA_ID_INCLUDE_OWNERS_AS_MEMBERS: ${ENTRA_ID_INCLUDE_OWNERS_AS_MEMBERS}
      OPENID_GRAPH_SCOPES: ${OPENID_GRAPH_SCOPES}

      ###########################################################################
      # üü° SAML
      ###########################################################################
      # SAML_ENTRY_POINT: ${SAML_ENTRY_POINT}
      # SAML_ISSUER: ${SAML_ISSUER}
      # SAML_CERT: ${SAML_CERT}
      # SAML_CALLBACK_URL: ${SAML_CALLBACK_URL}
      # SAML_SESSION_SECRET: ${SAML_SESSION_SECRET}
      # SAML_EMAIL_CLAIM: ${SAML_EMAIL_CLAIM}
      # SAML_USERNAME_CLAIM: ${SAML_USERNAME_CLAIM}
      # SAML_GIVEN_NAME_CLAIM: ${SAML_GIVEN_NAME_CLAIM}
      # SAML_FAMILY_NAME_CLAIM: ${SAML_FAMILY_NAME_CLAIM}
      # SAML_PICTURE_CLAIM: ${SAML_PICTURE_CLAIM}
      # SAML_NAME_CLAIM: ${SAML_NAME_CLAIM}
      # SAML_BUTTON_LABEL: ${SAML_BUTTON_LABEL}
      # SAML_IMAGE_URL: ${SAML_IMAGE_URL}

      ###########################################################################
      # üü° LDAP
      ###########################################################################
      # LDAP_URL: ${LDAP_URL}
      # LDAP_BIND_DN: ${LDAP_BIND_DN}
      # LDAP_BIND_CREDENTIALS: ${LDAP_BIND_CREDENTIALS}
      # LDAP_USER_SEARCH_BASE: ${LDAP_USER_SEARCH_BASE}
      # LDAP_CA_CERT_PATH: ${LDAP_CA_CERT_PATH}

      ###########################################################################
      # ‚úâÔ∏è Mail
      ###########################################################################
      # EMAIL_SERVICE: ${EMAIL_SERVICE}
      # EMAIL_HOST: ${EMAIL_HOST}
      # EMAIL_PORT: ${EMAIL_PORT}
      # EMAIL_ENCRYPTION: ${EMAIL_ENCRYPTION}
      # EMAIL_ENCRYPTION_HOSTNAME: ${EMAIL_ENCRYPTION_HOSTNAME}
      # EMAIL_ALLOW_SELFSIGNED: ${EMAIL_ALLOW_SELFSIGNED}
      # EMAIL_USERNAME: ${EMAIL_USERNAME}
      # EMAIL_PASSWORD: ${EMAIL_PASSWORD}
      # EMAIL_FROM_NAME: ${EMAIL_FROM_NAME}
      # EMAIL_FROM: ${EMAIL_FROM}

      ###########################################################################
      # üü° Firebase
      ###########################################################################
      # FIREBASE_API_KEY: ${FIREBASE_API_KEY}
      # FIREBASE_AUTH_DOMAIN: ${FIREBASE_AUTH_DOMAIN}
      # FIREBASE_PROJECT_ID: ${FIREBASE_PROJECT_ID}
      # FIREBASE_STORAGE_BUCKET: ${FIREBASE_STORAGE_BUCKET}
      # FIREBASE_MESSAGING_SENDER_ID: ${FIREBASE_MESSAGING_SENDER_ID}
      # FIREBASE_APP_ID: ${FIREBASE_APP_ID}

      ###########################################################################
      # üü° AWS S3 / Object Storage
      ###########################################################################
      # AWS_ENDPOINT_URL: ${AWS_ENDPOINT_URL}
      # AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
      # AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
      # AWS_REGION: ${AWS_REGION}
      # AWS_BUCKET_NAME: ${AWS_BUCKET_NAME}

      ###########################################################################
      # üü° Azure Storage
      ###########################################################################
      # AZURE_STORAGE_CONNECTION_STRING: ${AZURE_STORAGE_CONNECTION_STRING}
      # AZURE_STORAGE_PUBLIC_ACCESS: ${AZURE_STORAGE_PUBLIC_ACCESS}
      # AZURE_CONTAINER_NAME: ${AZURE_CONTAINER_NAME}

      ###########################################################################
      # üîó Sharing / Branding
      ###########################################################################
      ALLOW_SHARED_LINKS: ${ALLOW_SHARED_LINKS}
      ALLOW_SHARED_LINKS_PUBLIC: ${ALLOW_SHARED_LINKS_PUBLIC}
      APP_TITLE: ${APP_TITLE}
      HELP_AND_FAQ_URL: ${HELP_AND_FAQ_URL}

      ###########################################################################
      # üå¶Ô∏è Sonstiger Kram 
      ###########################################################################
      OPENWEATHER_API_KEY: ${OPENWEATHER_API_KEY}

      ###########################################################################
      # ü§ñ Azure OpenAI | Microsoft Foundry 
      ###########################################################################

      # OpenAI / GPT-5-nano
      AZURE_OPENAI_API_KEY: ${AZURE_OPENAI_API_KEY}
      AZURE_OPENAI_INSTANCE: ${AZURE_OPENAI_INSTANCE}
      AZURE_OPENAI_API_VERSION: ${AZURE_OPENAI_API_VERSION}
      AZURE_OPENAI_DEPLOYMENT_GPT41: ${AZURE_OPENAI_DEPLOYMENT_GPT41}
      AZURE_OPENAI_DEPLOYMENT_GPT5nano: ${AZURE_OPENAI_DEPLOYMENT_GPT5nano}

      ENDPOINTS: ${ENDPOINTS}

    volumes:
      - ./librechat.yaml:/app/librechat.yaml
      - /var/docker/librechat/images:/app/client/public/images
      - /var/docker/librechat/uploads:/app/uploads
      - /var/docker/librechat/logs:/app/logs

  api-plus:
    image: ghcr.io/danny-avila/librechat-dev:latest
    container_name: Librechat-Plus
    restart: unless-stopped
    user: "${UID}:${GID}"

    depends_on:
      - mongodb
      - meilisearch
      - vectordb

    ports:
      - "${PORT_PLUS:-3082}:3080"

    volumes:
      - type: bind
        source: ./.env
        target: /app/.env
      - ./librechat-plus.yaml:/app/librechat.yaml
      - /var/docker/librechat/images:/app/client/public/images
      - /var/docker/librechat/uploads:/app/uploads
      - /var/docker/librechat/logs-plus:/app/logs

    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      HOST: "0.0.0.0"
      MONGO_URI: mongodb://mongodb:27017/LibreChat
      MEILI_HOST: http://meilisearch:7700
      RAG_PORT: ${RAG_PORT:-8000}
      RAG_API_URL: http://rag_api:${RAG_PORT:-8000}
      LIBRECHAT_CONFIG_PATH: /app/librechat.yaml
      APP_TITLE: ${APP_TITLE_PLUS:-LibreChat Plus}
      ###########################################################################
      # üîµ Basis / Debug
      ###########################################################################
      DEBUG_CONSOLE: ${DEBUG_CONSOLE}
      DEBUG_LOGGING: ${DEBUG_LOGGING}
      DEBUG_OPENAI: ${DEBUG_OPENAI}
      DEBUG_PLUGINS: ${DEBUG_PLUGINS}
      CONSOLE_JSON: ${CONSOLE_JSON}
      NO_INDEX: ${NO_INDEX}
      TRUST_PROXY: ${TRUST_PROXY}

      ###########################################################################
      # üåê Domains
      ###########################################################################
      DOMAIN_CLIENT: ${DOMAIN_CLIENT_PLUS}
      DOMAIN_SERVER: ${DOMAIN_SERVER_PLUS}

      ###########################################################################
      # üßë‚Äçüíª Auth-Optionen 
      ###########################################################################
      ALLOW_SOCIAL_LOGIN: ${ALLOW_SOCIAL_LOGIN}
      ALLOW_EMAIL_LOGIN: ${ALLOW_EMAIL_LOGIN}
      ALLOW_REGISTRATION: ${ALLOW_REGISTRATION}
      ALLOW_PASSWORD_RESET: ${ALLOW_PASSWORD_RESET}
      ALLOW_UNVERIFIED_EMAIL_LOGIN: ${ALLOW_UNVERIFIED_EMAIL_LOGIN}

      ###########################################################################
      # üîê Krypto / Tokens 
      ###########################################################################
      CREDS_KEY: ${CREDS_KEY}
      CREDS_IV: ${CREDS_IV}
      JWT_SECRET: ${JWT_SECRET}
      JWT_REFRESH_SECRET: ${JWT_REFRESH_SECRET}
      SESSION_EXPIRY: ${SESSION_EXPIRY}
      REFRESH_TOKEN_EXPIRY: ${REFRESH_TOKEN_EXPIRY}
      MEILI_MASTER_KEY: ${MEILI_MASTER_KEY}

      ###########################################################################
      # ü™™ OpenID-Login
      ###########################################################################
      OPENID_CLIENT_ID: ${OPENID_CLIENT_ID}
      OPENID_CLIENT_SECRET: ${OPENID_CLIENT_SECRET}
      OPENID_ISSUER: ${OPENID_ISSUER}
      OPENID_SESSION_SECRET: ${OPENID_SESSION_SECRET}
      OPENID_SCOPE: ${OPENID_SCOPE}
      OPENID_CALLBACK_URL: ${OPENID_CALLBACK_URL}

      # Rollen / Claims
      OPENID_REQUIRED_ROLE: ${OPENID_REQUIRED_ROLE_PLUS}
      OPENID_REQUIRED_ROLE_TOKEN_KIND: ${OPENID_REQUIRED_ROLE_TOKEN_KIND}
      OPENID_REQUIRED_ROLE_PARAMETER_PATH: ${OPENID_REQUIRED_ROLE_PARAMETER_PATH}

      OPENID_ADMIN_ROLE: ${OPENID_ADMIN_ROLE}
      OPENID_ADMIN_ROLE_TOKEN_KIND: ${OPENID_ADMIN_ROLE_TOKEN_KIND}
      OPENID_ADMIN_ROLE_PARAMETER_PATH: ${OPENID_ADMIN_ROLE_PARAMETER_PATH}

      # UI / Verhalten
      OPENID_BUTTON_LABEL: ${OPENID_BUTTON_LABEL}
      OPENID_IMAGE_URL: ${OPENID_IMAGE_URL}
      OPENID_AUTO_REDIRECT: ${OPENID_AUTO_REDIRECT}
      OPENID_USE_PKCE: ${OPENID_USE_PKCE}
      OPENID_REUSE_TOKENS: ${OPENID_REUSE_TOKENS}

      # People Search / Graph
      USE_ENTRA_ID_FOR_PEOPLE_SEARCH: ${USE_ENTRA_ID_FOR_PEOPLE_SEARCH}
      ENTRA_ID_INCLUDE_OWNERS_AS_MEMBERS: ${ENTRA_ID_INCLUDE_OWNERS_AS_MEMBERS}
      OPENID_GRAPH_SCOPES: ${OPENID_GRAPH_SCOPES}

      ###########################################################################
      # üü° SAML
      ###########################################################################
      # SAML_ENTRY_POINT: ${SAML_ENTRY_POINT}
      # SAML_ISSUER: ${SAML_ISSUER}
      # SAML_CERT: ${SAML_CERT}
      # SAML_CALLBACK_URL: ${SAML_CALLBACK_URL}
      # SAML_SESSION_SECRET: ${SAML_SESSION_SECRET}
      # SAML_EMAIL_CLAIM: ${SAML_EMAIL_CLAIM}
      # SAML_USERNAME_CLAIM: ${SAML_USERNAME_CLAIM}
      # SAML_GIVEN_NAME_CLAIM: ${SAML_GIVEN_NAME_CLAIM}
      # SAML_FAMILY_NAME_CLAIM: ${SAML_FAMILY_NAME_CLAIM}
      # SAML_PICTURE_CLAIM: ${SAML_PICTURE_CLAIM}
      # SAML_NAME_CLAIM: ${SAML_NAME_CLAIM}
      # SAML_BUTTON_LABEL: ${SAML_BUTTON_LABEL}
      # SAML_IMAGE_URL: ${SAML_IMAGE_URL}

      ###########################################################################
      # üü° LDAP
      ###########################################################################
      # LDAP_URL: ${LDAP_URL}
      # LDAP_BIND_DN: ${LDAP_BIND_DN}
      # LDAP_BIND_CREDENTIALS: ${LDAP_BIND_CREDENTIALS}
      # LDAP_USER_SEARCH_BASE: ${LDAP_USER_SEARCH_BASE}
      # LDAP_CA_CERT_PATH: ${LDAP_CA_CERT_PATH}

      ###########################################################################
      # ‚úâÔ∏è Mail
      ###########################################################################
      # EMAIL_SERVICE: ${EMAIL_SERVICE}
      # EMAIL_HOST: ${EMAIL_HOST}
      # EMAIL_PORT: ${EMAIL_PORT}
      # EMAIL_ENCRYPTION: ${EMAIL_ENCRYPTION}
      # EMAIL_ENCRYPTION_HOSTNAME: ${EMAIL_ENCRYPTION_HOSTNAME}
      # EMAIL_ALLOW_SELFSIGNED: ${EMAIL_ALLOW_SELFSIGNED}
      # EMAIL_USERNAME: ${EMAIL_USERNAME}
      # EMAIL_PASSWORD: ${EMAIL_PASSWORD}
      # EMAIL_FROM_NAME: ${EMAIL_FROM_NAME}
      # EMAIL_FROM: ${EMAIL_FROM}

      ###########################################################################
      # üü° Firebase
      ###########################################################################
      # FIREBASE_API_KEY: ${FIREBASE_API_KEY}
      # FIREBASE_AUTH_DOMAIN: ${FIREBASE_AUTH_DOMAIN}
      # FIREBASE_PROJECT_ID: ${FIREBASE_PROJECT_ID}
      # FIREBASE_STORAGE_BUCKET: ${FIREBASE_STORAGE_BUCKET}
      # FIREBASE_MESSAGING_SENDER_ID: ${FIREBASE_MESSAGING_SENDER_ID}
      # FIREBASE_APP_ID: ${FIREBASE_APP_ID}

      ###########################################################################
      # üü° AWS S3 / Object Storage
      ###########################################################################
      # AWS_ENDPOINT_URL: ${AWS_ENDPOINT_URL}
      # AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
      # AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
      # AWS_REGION: ${AWS_REGION}
      # AWS_BUCKET_NAME: ${AWS_BUCKET_NAME}

      ###########################################################################
      # üü° Azure Storage
      ###########################################################################
      # AZURE_STORAGE_CONNECTION_STRING: ${AZURE_STORAGE_CONNECTION_STRING}
      # AZURE_STORAGE_PUBLIC_ACCESS: ${AZURE_STORAGE_PUBLIC_ACCESS}
      # AZURE_CONTAINER_NAME: ${AZURE_CONTAINER_NAME}

      ###########################################################################
      # üîó Sharing / Branding
      ###########################################################################
      ALLOW_SHARED_LINKS: ${ALLOW_SHARED_LINKS}
      ALLOW_SHARED_LINKS_PUBLIC: ${ALLOW_SHARED_LINKS_PUBLIC}
      HELP_AND_FAQ_URL: ${HELP_AND_FAQ_URL}

      ###########################################################################
      # üå¶Ô∏è Sonstiger Kram 
      ###########################################################################
      OPENWEATHER_API_KEY: ${OPENWEATHER_API_KEY}

      ###########################################################################
      # ü§ñ Azure OpenAI | Microsoft Foundry 
      ###########################################################################

      # OpenAI / GPT-4.1
      AZURE_OPENAI_API_KEY: ${AZURE_OPENAI_API_KEY}
      AZURE_OPENAI_INSTANCE: ${AZURE_OPENAI_INSTANCE}
      AZURE_OPENAI_API_VERSION: ${AZURE_OPENAI_API_VERSION}
      AZURE_OPENAI_DEPLOYMENT_GPT41: ${AZURE_OPENAI_DEPLOYMENT_GPT41}
      
      # Foundry / GPT-5.1
      AZURE_FOUNDRY_API_KEY: ${AZURE_FOUNDRY_API_KEY}
      AZURE_FOUNDRY_BASEURL: ${AZURE_FOUNDRY_BASEURL}
      AZURE_FOUNDRY_BASEURL_GPT51: ${AZURE_FOUNDRY_BASEURL_GPT51}

      AZURE_GPT51_API_KEY: ${AZURE_GPT51_API_KEY}
      AZURE_GPT51_INSTANCE: ${AZURE_GPT51_INSTANCE}
      AZURE_GPT51_API_VERSION: ${AZURE_GPT51_API_VERSION}
      AZURE_GPT51_DEPLOYMENT: ${AZURE_GPT51_DEPLOYMENT}

      ENDPOINTS: ${ENDPOINTS_PLUS}

  mongodb:
    volumes:
      - /var/docker/librechat/mongo:/data/db

  meilisearch:
    volumes:
      - /var/docker/librechat/meili:/meili_data

  vectordb:
    volumes:
      - /var/docker/librechat/pgdata2:/var/lib/postgresql/data
